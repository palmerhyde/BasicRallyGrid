<!DOCTYPE html>
<html>
<head>
    <title>BasicRallyGrid</title>

    <script type="text/javascript" src="https://rally1.rallydev.com/apps/2.1/sdk.js"></script>

    <script type="text/javascript">
        Rally.onReady(function () {
                Ext.define("CustomApp",{extend:"Rally.app.App",componentCls:"app",items:[{xtype:"container",itemId:"pulldown-container",layout:{type:"hbox",align:"stretch"}}],launch:function(){console.log(this.getContext().getDataContext()),this.loadReleases()},loadReleases:function(){var t=Ext.create("Rally.ui.combobox.ReleaseComboBox",{itemId:"releasePicker",fieldLabel:"Release",labelAlign:"right",listeners:{ready:this.loadData,select:this.loadData,scope:this}});this.down("#pulldown-container").add(t)},getFilters:function(t){var e=Ext.create("Rally.data.wsapi.Filter",{property:"Release",operation:"=",value:t});return filters=e},loadData:function(){var t=this.down("#releasePicker").getRecord().get("_ref");console.log(t);var e=this.getFilters(t);this.store?(this.store.setFilter(e),this.store.load()):this.store=Ext.create("Rally.data.wsapi.Store",{model:"PortfolioItem/EPIC",autoLoad:!0,filters:e,listeners:{load:function(t,e,a){this.createGrid(t,e)},scope:this},fetch:["FormattedID","Name","Parent","State","c_CurrentQtrRank","Project"],context:this.getContext().getDataContext()})},createGrid:function(t,e){var a=_.map(e,function(t){var e=999,a="",r="";return null!=t.get("Parent")&&null!=t.get("Parent").c_CurrentQtrRank&&(e=t.get("Parent").c_CurrentQtrRank),null!=t.get("Parent")&&null!=t.get("Parent").Name&&(a=t.get("Parent").Name),null!=t.get("Project")&&null!=t.get("Project").Name&&(r=t.get("Project").Name),Ext.apply({Rank:e,MBI:a,Team:r},t.getData())});this.grid&&this.remove(this.grid),this.grid=Ext.create("Rally.ui.grid.Grid",{showRowActionsColumn:!1,store:Ext.create("Rally.data.custom.Store",{data:a}),columnCfgs:[{xtype:"templatecolumn",text:"ID",dataIndex:"FormattedID",width:100,tpl:Ext.create("Rally.ui.renderer.template.FormattedIDTemplate")},{text:"Name",dataIndex:"Name",flex:1},{text:"Rank",dataIndex:"Rank"},{text:"MBI",dataIndex:"MBI",flex:1},{text:"Project",dataIndex:"Team"}]}),this.add(this.grid)}});

            Rally.launchApp('CustomApp', {
                name:"BasicRallyGrid",
                parentRepos:"",
                version:"0.1.1"
            });

        });
    </script>


    <style type="text/css">
        
    </style>
</head>
<body>
</body>
</html>
